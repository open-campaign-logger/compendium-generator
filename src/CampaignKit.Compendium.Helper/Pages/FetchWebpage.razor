@page "/fetchwebpage"
@using CampaignKit.Compendium.Helper.Data
@inject DownloadService downloadService

<PageTitle>Compendium Helper</PageTitle>

<h1>Compendium Helper</h1>

<p>This component demonstrates fetching data from a service.</p>

<div class="row">
    <div class="col-md-12">
        <input type="text" @bind="url" placeholder="Enter web page URL" class="form-control" />
        <button @onclick="LoadWebPageContent" class="btn btn-primary mt-2">Load</button>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <textarea @bind="markdown" class="form-control" rows="20"></textarea>
    </div>
</div>

@code {
    private string url = "https://www.woinrules.com/characters/derived-statistics";
    private string markdown = string.Empty;

    private async Task LoadWebPageContent()
    {
        markdown = "Loading...";
        var html = await downloadService.GetWebPage(url);
        markdown = MarkdownService.ConvertHtmlToMarkdown(html);
    }
}
